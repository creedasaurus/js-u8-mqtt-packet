{"version":3,"file":"web.min.mjs","sources":["../client/web.mjs","../../code/demo/web.jsy"],"sourcesContent":["function encode_varint(n, a=[]) {\n  do {\n    const ni = n & 0x7f;\n    n >>>= 7;\n    a.push(ni | (0===n ? 0 : 0x80)); }\n  while (n > 0)\n  return a}\n\n\nfunction decode_varint(u8, vi=0, vi_tuple=[]) {\n  // unrolled for a max of 4 chains\n  let n = (u8[vi] & 0x7f) <<  0;\n  if (0x80 & u8[vi++]) {\n    n |= (u8[vi] & 0x7f) <<  7;\n    if (0x80 & u8[vi++]) {\n      n |= (u8[vi] & 0x7f) << 14;\n      if (0x80 & u8[vi++]) {\n        n |= (u8[vi] & 0x7f) << 21;} } }\n\n  vi_tuple[0] = n;\n  vi_tuple[1] = vi;\n  return vi_tuple}\n\nconst [mqtt_props_by_id, mqtt_props_entries] = ((() => {\n  const entries =[\n    [0x01, 'u8',   'payload_format_indicator']\n  , [0x02, 'u32',  'message_expiry_interval', ]\n  , [0x03, 'utf8', 'content_type', ]\n  , [0x08, 'utf8', 'response_topic', ]\n  , [0x09, 'bin',  'correlation_data', ]\n  , [0x0B, 'vint', 'subscription_identifier', ]\n  , [0x11, 'u32',  'session_expiry_interval', ]\n  , [0x12, 'utf8', 'assigned_client_identifier', ]\n  , [0x13, 'u16',  'server_keep_alive', ]\n  , [0x15, 'utf8', 'authentication_method', ]\n  , [0x16, 'bin',  'authentication_data', ]\n  , [0x17, 'u8',   'request_problem_information', ]\n  , [0x18, 'u32',  'will_delay_interval', ]\n  , [0x19, 'u8',   'request_response_information', ]\n  , [0x1A, 'utf8', 'response_information', ]\n  , [0x1C, 'utf8', 'server_reference', ]\n  , [0x1F, 'utf8', 'reason_string', ]\n  , [0x21, 'u16',  'receive_maximum', ]\n  , [0x22, 'u16',  'topic_alias_maximum', ]\n  , [0x23, 'u16',  'topic_alias', ]\n  , [0x24, 'u8',   'maximum_qo_s', ]\n  , [0x25, 'u8',   'retain_available', ]\n  , [0x26, 'pair', 'user_properties', true]\n  , [0x27, 'u32',  'maximum_packet_size', ]\n  , [0x28, 'u8',   'wildcard_subscription_available', ]\n  , [0x29, 'u8',   'subscription_identifiers_available', true]\n  , [0x2A, 'u8',   'shared_subscription_available', ] ];\n\n\n  const prop_map = new Map();\n  for (const [id, type, name, plural] of entries) {\n    const prop_obj = {id, type, name};\n    if (plural) {prop_obj.plural = plural;}\n    prop_map.set(prop_obj.id, prop_obj);\n    prop_map.set(prop_obj.name, prop_obj);}\n\n  return [\n    prop_map.get.bind(prop_map)\n  , Array.from(prop_map.values()) ] })());\n\nclass mqtt_type_reader {\n  constructor(buf, idx=0) {\n    this.buf = buf;\n    this.step = (width, r) =>(r = idx, idx += width, r); }\n\n  has_more() {\n    const {buf, step} = this;\n    return buf.byteLength > step(0)}\n\n  u8() {\n    const {buf, step} = this;\n    return buf[step(1)]}\n\n  u16() {\n    const {buf, step} = this;\n    const i = step(2);\n    return (buf[i]<<8) | buf[i+1]}\n\n  u32() {\n    const {buf, step} = this;\n    const i = step(4);\n    return (buf[i]<<24) | (buf[i+1]<<16) | (buf[i+2]<<8) | buf[i+3]}\n\n  vint() {\n    const {buf, step} = this;\n    const [n, vi] = decode_varint(buf, step(0));\n    step(vi);\n    return n}\n\n  bin() {\n    const {buf, step} = this;\n    const i = step(2);\n    const len = (buf[i]<<8) | buf[i+1];\n    const i0 = step(len);\n    return buf.subarray(i0, i0+len)}\n\n  utf8() {return new TextDecoder('utf-8').decode(this.bin())}\n  pair() {return [this.utf8(), this.utf8()]}\n\n  u8_flags(FlagsType) {\n    const {buf, step} = this;\n    return new FlagsType(buf[step(1)])}\n\n  u8_reason(fn_reason) {\n    const {buf, step} = this;\n    return fn_reason(buf[step(1)]) }\n\n  flush() {\n    const {buf, step} = this;\n    this.step = this.buf = null;\n    return buf.subarray(step(0))}\n\n  props() {\n    const {buf, step} = this;\n\n    const [len, vi] = decode_varint(buf, step(0));\n    const end_part = vi + len;\n    step(end_part);\n    if (0 === len) {\n      return null}\n\n    const prop_entries =[];\n    const rdr = mqtt_reader(\n      buf.subarray(vi, end_part));\n\n    while (rdr.has_more()) {\n      const {name, type} = mqtt_props_by_id(rdr.u8());\n      const value = rdr[type]();\n      prop_entries.push([name, value]); }\n\n    return prop_entries} }\n\n\n\nclass U8_Reason extends Number {\n  constructor(u8, reason) {\n    super(u8);\n    this.reason = reason;} }\n\nfunction bind_reason_lookup(reason_entries) {\n  const reason_map = new Map();\n  for (const [u8, reason] of reason_entries) {\n    reason_map.set(u8, new U8_Reason(u8, reason)); }\n\n  return reason_map.get.bind(reason_map)}\n\nclass _connect_flags_ extends Number {\n  get reserved() {return this & 0x01 !== 0}\n  get clean_start() {return this & 0x02 !== 0}\n  get will_flag() {return this & 0x04 !== 0}\n  get will_qos() {return (this >>> 3) & 0x3}\n  get will_retain() {return this & 0x20 !== 0}\n  get password() {return this & 0x40 !== 0}\n  get username() {return this & 0x80 !== 0} }\n\n\nfunction mqtt_decode_connect(pkt) {\n  const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n  if ('MQTT' !== rdr.utf8()) {\n    throw new Error('Invalid mqtt_connect packet') }\n\n  pkt._base_.mqtt_level = pkt.mqtt_level = rdr.u8();\n\n  const flags = pkt.connect_flags =\n    rdr.u8_flags(_connect_flags_);\n\n  pkt.keep_alive = rdr.u16();\n\n  if (5 <= pkt.mqtt_level) {\n    pkt.props = rdr.props();}\n\n\n\n  const payload = pkt.payload = {};\n  payload.client_id = rdr.utf8();\n  if (flags.will_flag) {\n    if (5 <= pkt.mqtt_level) {\n      payload.will_properties = rdr.props();}\n\n    payload.will_topic = rdr.utf8();\n    payload.will_payload = rdr.bin();}\n\n  if (flags.username) {\n    payload.username = rdr.utf8();}\n\n  if (flags.password) {\n    payload.password = rdr.bin();}\n  return pkt}\n\nclass _connack_flags_ extends Number {\n  get session_present() {return this & 0x01 !== 0} }\n\nconst _connack_reason_ = bind_reason_lookup([\n  // MQTT 3.1.1\n  [0x00, 'Success']\n, [0x01, 'Connection refused, unacceptable protocol version']\n, [0x02, 'Connection refused, identifier rejected']\n, [0x03, 'Connection refused, server unavailable']\n, [0x04, 'Connection refused, bad user name or password']\n, [0x05, 'Connection refused, not authorized']\n\n, // MQTT 5.0\n  [0x81, 'Malformed Packet']\n, [0x82, 'Protocol Error']\n, [0x83, 'Implementation specific error']\n, [0x84, 'Unsupported Protocol Version']\n, [0x85, 'Client Identifier not valid']\n, [0x86, 'Bad User Name or Password']\n, [0x87, 'Not authorized']\n, [0x88, 'Server unavailable']\n, [0x89, 'Server busy']\n, [0x8A, 'Banned']\n, [0x8C, 'Bad authentication method']\n, [0x90, 'Topic Name invalid']\n, [0x95, 'Packet too large']\n, [0x97, 'Quota exceeded']\n, [0x99, 'Payload format invalid']\n, [0x9A, 'Retain not supported']\n, [0x9B, 'QoS not supported']\n, [0x9C, 'Use another server']\n, [0x9D, 'Server moved']\n, [0x9F, 'Connection rate exceeded'] ]);\n\n\nfunction mqtt_decode_connack(pkt) {\n  const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n\n  const flags = pkt.connect_flags =\n    rdr.u8_flags(_connack_flags_);\n\n  pkt.reason = rdr.u8_reason(_connack_reason_);\n  if (5 <= pkt.mqtt_level) {\n    pkt.props = rdr.props();}\n  return pkt}\n\nfunction mqtt_decode_publish(pkt) {\n  const {hdr} = pkt;\n  pkt.dup = Boolean(hdr & 0x8);\n  pkt.retain = Boolean(hdr & 0x1);\n  const qos = pkt.qos = (hdr>>1) & 0x3;\n\n  const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n  pkt.topic = rdr.utf8();\n  if (0 !== qos) {\n    pkt.pkt_id = rdr.u16();}\n\n  if (5 <= pkt.mqtt_level) {\n    pkt.props = rdr.props();\n    pkt.payload = rdr.flush();}\n  else {\n    pkt.payload = rdr.flush();}\n\n  return pkt}\n\nconst _puback_reason_ = bind_reason_lookup([\n  [0x00, 'Success']\n\n, // MQTT 5.0\n  [0x10, 'No matching subscribers']\n, [0x80, 'Unspecified error']\n, [0x83, 'Implementation specific error']\n, [0x87, 'Not authorized']\n, [0x90, 'Topic Name invalid']\n, [0x91, 'Packet identifier in use']\n, [0x97, 'Quota exceeded']\n, [0x99, 'Payload format invalid'] ]);\n\n\nfunction mqtt_decode_puback(pkt) {\n  const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n\n  pkt.pkt_id = rdr.u16();\n  if (5 <= pkt.mqtt_level) {\n    pkt.reason = rdr.u8_reason(_puback_reason_);\n    pkt.props = rdr.props();}\n\n  return pkt}\n\nconst _pubxxx_reason_ = bind_reason_lookup([\n  [0x00, 'Success']\n, [0x92, 'Packet Identifier not found'] ]);\n\n\nfunction _mqtt_decode_pubxxx(pkt) {\n  const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n\n  pkt.pkt_id = rdr.u16();\n  pkt.reason = rdr.u8_reason(_pubxxx_reason_);\n  if (5 <= pkt.mqtt_level) {\n    pkt.props = rdr.props();}\n  return pkt}\n\nclass _subscription_options_ extends Number {\n  get qos() {return this & 0x3}\n  get retain() {return this & 0x4 !== 0}\n  get retain_handling() {return (this >> 2) & 0x3} }\n\nfunction mqtt_decode_subscribe(pkt) {\n  const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n\n  pkt.pkt_id = rdr.u16();\n  if (5 <= pkt.mqtt_level) {\n    pkt.props = rdr.props();}\n\n  const topic_list = pkt.topics = [];\n  while (rdr.has_more()) {\n    topic_list.push({\n      topic: rdr.utf8()\n    , opts: rdr.u8_flags(_subscription_options_)}); }\n\n  return pkt}\n\nfunction _mqtt_decode_suback(pkt, _ack_reason_) {\n  const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n\n  pkt.pkt_id = rdr.u16();\n  if (5 <= pkt.mqtt_level) {\n    pkt.props = rdr.props();}\n\n  const answers = pkt.answers = [];\n  while (rdr.has_more()) {\n    answers.push(\n      rdr.u8_reason(_ack_reason_)); }\n\n  return pkt}\n\nconst _suback_reason_ = bind_reason_lookup([\n  // MQTT 3.1.1\n  [0x00, 'Granted QoS 0']\n, [0x01, 'Granted QoS 1']\n, [0x02, 'Granted QoS 2']\n\n, // MQTT 5.0\n  [0x80, 'Unspecified error']\n, [0x83, 'Implementation specific error']\n, [0x87, 'Not authorized']\n, [0x8F, 'Topic Filter invalid']\n, [0x91, 'Packet Identifier in use']\n, [0x97, 'Quota exceeded']\n, [0x9E, 'Shared Subscriptions not supported']\n, [0xA1, 'Subscription Identifiers not supported']\n, [0xA2, 'Wildcard Subscriptions not supported'] ]);\n\n\nfunction mqtt_decode_suback(pkt) {\n  return _mqtt_decode_suback(\n    pkt, _suback_reason_) }\n\nfunction mqtt_decode_unsubscribe(pkt) {\n  const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n\n  pkt.pkt_id = rdr.u16();\n  if (5 <= pkt.mqtt_level) {\n    pkt.props = rdr.props();}\n\n  const topic_list = pkt.topics = [];\n  while (rdr.has_more()) {\n    topic_list.push(rdr.utf8()); }\n\n  return pkt}\n\nconst _unsuback_reason_ = bind_reason_lookup([\n  [0x00, 'Success']\n, [0x11, 'No subscription existed']\n, [0x80, 'Unspecified error']\n, [0x83, 'Implementation specific error']\n, [0x87, 'Not authorized']\n, [0x8F, 'Topic Filter invalid']\n, [0x91, 'Packet Identifier in use'] ]);\n\nfunction mqtt_decode_unsuback(pkt) {\n  return _mqtt_decode_suback(\n    pkt, _unsuback_reason_) }\n\nconst _disconnect_reason_ = bind_reason_lookup([\n  // MQTT 5.0\n  [0x00, 'Normal disconnection']\n, [0x04, 'Disconnect with Will Message']\n, [0x80, 'Unspecified error']\n, [0x81, 'Malformed Packet']\n, [0x82, 'Protocol Error']\n, [0x83, 'Implementation specific error']\n, [0x87, 'Not authorized']\n, [0x89, 'Server busy']\n, [0x8B, 'Server shutting down']\n, [0x8D, 'Keep Alive timeout']\n, [0x8E, 'Session taken over']\n, [0x8F, 'Topic Filter invalid']\n, [0x90, 'Topic Name invalid']\n, [0x93, 'Receive Maximum exceeded']\n, [0x94, 'Topic Alias invalid']\n, [0x95, 'Packet too large']\n, [0x96, 'Message rate too high']\n, [0x97, 'Quota exceeded']\n, [0x98, 'Administrative action']\n, [0x99, 'Payload format invalid']\n, [0x9A, 'Retain not supported']\n, [0x9B, 'QoS not supported']\n, [0x9C, 'Use another server']\n, [0x9D, 'Server moved']\n, [0x9E, 'Shared Subscriptions not supported']\n, [0x9F, 'Connection rate exceeded']\n, [0xA0, 'Maximum connect time']\n, [0xA1, 'Subscription Identifiers not supported']\n, [0xA2, 'Wildcard Subscriptions not supported'] ]);\n\n\nfunction mqtt_decode_disconnect(pkt) {\n  if (5 <= pkt.mqtt_level) {\n    const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n    pkt.reason = rdr.u8_reason(_disconnect_reason_);\n    pkt.props = rdr.props();}\n  return pkt}\n\nconst _auth_reason_ = bind_reason_lookup([\n  // MQTT 5.0\n  [0x00, 'Success']\n, [0x18, 'Continue authentication']\n, [0x19, 'Re-authenticate'] ]);\n\nfunction mqtt_decode_auth(pkt) {\n  if (5 <= pkt.mqtt_level) {\n    const rdr = new mqtt_type_reader(pkt.u8_body, 0);\n    pkt.reason = rdr.u8_reason(_auth_reason_);\n    pkt.props = rdr.props();}\n  return pkt}\n\nfunction mqtt_dnu_decode(pkt) {\n  const err = new Error('MQTT packet not understood');\n  err.pkt = pkt;\n  throw err}\n\nconst mqtt_decode_noop = pkt => pkt;\n\n\nconst mqtt_decode_ops_by_id =[\n  mqtt_dnu_decode\n, mqtt_decode_connect\n, mqtt_decode_connack\n, mqtt_decode_publish\n, mqtt_decode_puback\n, _mqtt_decode_pubxxx\n, _mqtt_decode_pubxxx\n, _mqtt_decode_pubxxx\n, mqtt_decode_subscribe\n, mqtt_decode_suback\n, mqtt_decode_unsubscribe\n, mqtt_decode_unsuback\n, mqtt_decode_noop // mqtt_decode_pingreq\n, mqtt_decode_noop // mqtt_decode_pingresp\n, mqtt_decode_disconnect\n, mqtt_decode_auth];\n\nfunction mqtt_pkt_writer_pool() {\n  const _pool_ = [];\n  return (() =>0 === _pool_.length\n      ? mqtt_pkt_writer(_pool_)\n      : _pool_.pop()) }\n\nfunction mqtt_pkt_writer(_pool_) {\n  let self, n=0, rope=[];\n  return self ={\n    push(u8) {\n      \n\n\n      rope.push(u8);\n      n += u8.length;}\n\n  , as_pkt(hdr) {\n      const pkt = _mqtt_pkt_rope(hdr, n, rope);\n      n=0; rope=[];\n      if (undefined !== _pool_) {\n        _pool_.push(self);}\n      return pkt} } }\n\nfunction _mqtt_pkt_rope(hdr, n, rope) {\n  const header = encode_varint(n, [hdr]);\n  let i = header.length;\n\n  const pkt = new Uint8Array(n + i);\n  pkt.set(header, 0);\n  for (const vec of rope) {\n    pkt.set(vec, i);\n    i += vec.length;}\n  return pkt}\n\nconst pack_utf8 = v => new TextEncoder('utf-8').encode(v);\nconst pack_u16 = v =>[(v>>>8) & 0xff, v & 0xff];\nconst pack_u32 = v =>[(v>>>24) & 0xff, (v>>>16) & 0xff, (v>>>8) & 0xff, v & 0xff];\n\nclass mqtt_type_writer {\n  constructor() {\n    Object.assign(this, this._pkt_writer()); }\n\n  u8(v) {this.push([v & 0xff]);}\n  u16(v) {this.push(pack_u16(v));}\n  u32(v) {this.push(pack_u32(v));}\n  vint(v) {this.push(encode_varint(v));}\n\n  _u16_bin(u8_buf) {\n    const {push} = this;\n    push(pack_u16(u8_buf.byteLength));\n    push(u8_buf); }\n\n  flush(buf) {\n    this.push(\n      'string' === typeof buf\n        ? pack_utf8(buf) : buf);\n\n    this.push = false;}\n\n  bin(u8_buf) {\n    if ('string' === typeof u8_buf) {\n      return this.utf8(u8_buf)}\n\n    if (u8_buf.length !== u8_buf.byteLength) {\n      u8_buf = new Uint8Array(u8_buf);}\n    this._u16_bin(u8_buf);}\n\n  utf8(v) {this._u16_bin(\n    new TextEncoder('utf-8').encode(v)); }\n\n  pair(k,v) {\n    this.utf8(k);\n    this.utf8(v);}\n\n  u8_flags(v, enc_flags) {\n    if (undefined !== v && isNaN(+v)) {\n      v = enc_flags(v, 0);}\n    v |= 0;\n    this.push([v]);\n    return v}\n\n  u8_reason(v) {this.push([v | 0]);}\n\n  props() {throw \"TODO\"} }\n\nmqtt_type_writer.prototype._pkt_writer = \n  mqtt_pkt_writer_pool();\n\nconst _c_mqtt_proto = new Uint8Array([\n  0, 4, 0x4d, 0x51, 0x54, 0x54]);\n\nfunction mqtt_encode_connect(mqtt_level, pkt) {\n  const wrt = new mqtt_type_writer();\n\n  wrt.push(_c_mqtt_proto);\n  wrt.u8(mqtt_level);\n  const flags = wrt.u8_flags(\n    pkt.connect_flags\n  , _enc_connect_flags);\n\n  wrt.u16(pkt.keep_alive);\n\n  if (5 <= mqtt_level) {\n    wrt.props(pkt.props);}\n\n\n  const {payload} = pkt;\n  wrt.utf8(payload.client_id);\n  if (flags & 0x04) {// .will_flag\n    if (5 <= mqtt_level) {\n      wrt.props(payload.will_properties); }\n\n    wrt.utf8(payload.will_topic);\n    wrt.bin(payload.will_payload); }\n\n  if (flags & 0x80) {// .username\n    wrt.utf8(payload.username); }\n\n  if (flags & 0x40) {// .password\n    wrt.bin(payload.password); }\n\n  return wrt.as_pkt(0x10)}\n\nconst _enc_connect_flags = flags => 0\n    |(flags.reserved ? 0x01 : 0)\n    |((flags.will_qos & 0x3) << 3)\n    |(flags.clean_start ? 0x02 : 0)\n    |(flags.will_flag ? 0x04 : 0)\n    |(flags.will_retain ? 0x20 : 0)\n    |(flags.password ? 0x40 : 0)\n    |(flags.username ? 0x80 : 0);\n\nfunction mqtt_encode_connack(mqtt_level, pkt) {\n  const wrt = new mqtt_type_writer();\n  wrt.u8_flags(pkt.connect_flags, _enc_flags_connack);\n\n  if (5 <= mqtt_level) {\n    wrt.u8_reason(pkt.reason);\n    wrt.props(pkt.props); }\n\n  else {\n    wrt.u8_reason(pkt.return_code || pkt.reason); }\n\n  return wrt.as_pkt(0x20)}\n\nconst _enc_flags_connack = connect_flags =>\n  connect_flags.session_present ? 1 : 0;\n\nfunction mqtt_encode_publish(mqtt_level, pkt) {\n  const qos = (pkt.qos & 0x3) << 1;\n  const wrt = new mqtt_type_writer();\n\n  wrt.utf8(pkt.topic);\n  if (0 !== qos) {\n    wrt.u16(pkt.pkt_id);}\n\n  if (5 <= mqtt_level) {\n    wrt.props(pkt.props);\n    wrt.flush(pkt.payload);}\n  else {\n    wrt.flush(pkt.payload);}\n\n  return wrt.as_pkt(\n    0x30 | qos | (pkt.dup ? 0x8 : 0) | (pkt.retain ? 0x1 : 0)) }\n\nfunction mqtt_encode_puback(mqtt_level, pkt) {\n  const wrt = new mqtt_type_writer();\n\n  wrt.u16(pkt.pkt_id);\n  if (5 <= mqtt_level) {\n    wrt.u8_reason(pkt.reason);\n    wrt.props(pkt.props);}\n\n  return wrt.as_pkt(0x40)}\n\nfunction _mqtt_encode_pubxxx(hdr, mqtt_level, pkt) {\n  const wrt = new mqtt_type_writer();\n\n  wrt.u16(pkt.pkt_id);\n  if (5 <= mqtt_level) {\n    wrt.props(pkt.props);\n    wrt.u8_reason(pkt.reason); }\n\n  else {\n    wrt.u8_reason(pkt.return_code || pkt.reason); }\n\n  return wrt.as_pkt(hdr)}\n\nfunction mqtt_encode_pubrec(mqtt_level, pkt) {\n  return _mqtt_encode_pubxxx(0x50, mqtt_level, pkt) }\n\nfunction mqtt_encode_pubrel(mqtt_level, pkt) {\n  return _mqtt_encode_pubxxx(0x62, mqtt_level, pkt) }\n\nfunction mqtt_encode_pubcomp(mqtt_level, pkt) {\n  return _mqtt_encode_pubxxx(0x70, mqtt_level, pkt) }\n\nfunction mqtt_encode_subscribe(mqtt_level, pkt) {\n  const wrt = new mqtt_type_writer();\n\n  wrt.u16(pkt.pkt_id);\n  if (5 <= pkt.mqtt_level) {\n    wrt.props(pkt.props);}\n\n  for (const each of pkt.topics) {\n    if ('string' === typeof each) {\n      wrt.utf8(each);\n      wrt.u8(0);}\n\n    else if (Array.isArray(each)) {\n      wrt.utf8(each[0]);\n      wrt.u8_flags(each[1], _enc_subscribe_flags);}\n\n    else {\n      wrt.utf8(each.topic);\n      wrt.u8_flags(each.opts, _enc_subscribe_flags);} }\n\n  return wrt.as_pkt(0x82)}\n\nconst _enc_subscribe_flags = opts => 0\n    |(opts.qos & 0x3)\n    |(opts.retain ? 0x4 : 0)\n    |((opts.retain_handling & 0x3) << 2  );\n\nfunction _mqtt_encode_suback(hdr, mqtt_level, pkt, key_answers) {\n  const wrt = new mqtt_type_writer();\n\n  wrt.u16(pkt.pkt_id);\n  if (5 <= pkt.mqtt_level) {\n    wrt.props(pkt.props); }\n\n  for (const ans of pkt[key_answers]) {\n    wrt.u8_reason(ans);}\n\n  return wrt.as_pkt(hdr)}\n\nfunction mqtt_encode_suback(mqtt_level, pkt) {\n  return _mqtt_encode_suback(\n    0x90, mqtt_level, pkt) }\n\nfunction mqtt_encode_unsubscribe(mqtt_level, pkt) {\n  const wrt = new mqtt_type_writer();\n\n  wrt.u16(pkt.pkt_id);\n  if (5 <= pkt.mqtt_level) {\n    wrt.props(pkt.props);}\n\n  for (const topic of pkt.topics) {\n    wrt.utf8(topic);}\n\n  return wrt.as_pkt(0xa2)}\n\nfunction mqtt_encode_unsuback(mqtt_level, pkt) {\n  return _mqtt_encode_suback(\n    0xb0, mqtt_level, pkt) }\n\nconst mqtt_encode_pingreq = (() =>\n  new Uint8Array([0xc0, 0]) );\n\nconst mqtt_encode_pingresp = (() =>\n  new Uint8Array([0xd0, 0]) );\n\nfunction mqtt_encode_disconnect(mqtt_level, pkt) {\n  const wrt = new mqtt_type_writer();\n\n  if (5 <= mqtt_level) {\n    wrt.u8_reason(pkt.reason);\n    wrt.props(pkt.props); }\n\n  return wrt.as_pkt(0xe0)}\n\nfunction mqtt_encode_auth(mqtt_level, pkt) {\n  if (5 > mqtt_level) {\n    throw new Error('Auth packets are only available after MQTT 5.x') }\n\n  const wrt = new mqtt_type_writer();\n\n  wrt.u8_reason(pkt.reason);\n  wrt.props(pkt.props);\n\n  return wrt.as_pkt(0xf0)}\n\nconst mqtt_encode_by_type ={\n  connect: mqtt_encode_connect\n, connack: mqtt_encode_connack\n, publish: mqtt_encode_publish\n, puback: mqtt_encode_puback\n, pubrec: mqtt_encode_pubrec\n, pubrel: mqtt_encode_pubrel\n, pubcomp: mqtt_encode_pubcomp\n, subscribe: mqtt_encode_subscribe\n, suback: mqtt_encode_suback\n, unsubscribe: mqtt_encode_unsubscribe\n, unsuback: mqtt_encode_unsuback\n, pingreq: mqtt_encode_pingreq\n, pingresp: mqtt_encode_pingresp\n, disconnect: mqtt_encode_disconnect\n, auth: mqtt_encode_auth};\n\nconst [mqtt_cmd_by_type, mqtt_type_entries] = ((() => {\n\n  const entries =[\n    [0x0, 'reserved']\n  , [0x1, 'connect']\n  , [0x2, 'connack']\n  , [0x3, 'publish']\n  , [0x4, 'puback']\n  , [0x5, 'pubrec']\n  , [0x6, 'pubrel']\n  , [0x7, 'pubcomp']\n  , [0x8, 'subscribe']\n  , [0x9, 'suback']\n  , [0xa, 'unsubscribe']\n  , [0xb, 'unsuback']\n  , [0xc, 'pingreq']\n  , [0xd, 'pingresp']\n  , [0xe, 'disconnect']\n  , [0xf, 'auth'] ];\n\n  const type_map = new Map();\n  for (const [id, type] of entries) {\n    const cmd = id << 4;\n    type_map.set(cmd, {type, cmd, id});}\n\n  return [\n    type_map.get.bind(type_map)\n  , Array.from(type_map.values()) ] })());\n\nfunction _mqtt_raw_pkt_decode_v(u8_ref, _pkt_ctx_) {\n  const [u8] = u8_ref;\n  const [len_body, len_vh] = decode_varint(u8, 1);\n\n  const len_pkt = len_body + len_vh;\n  if (u8.byteLength >= len_pkt) {\n    const b0 = u8[0], cmd = b0 & 0xf0;\n    u8_ref[0] = u8.subarray(len_pkt);\n    return {__proto__: _pkt_ctx_\n    , b0, cmd, id: b0>>>4, hdr: b0 & 0x0f\n    , type_obj: mqtt_cmd_by_type(cmd)\n    , u8_body: 0 === len_body ? null\n        : u8.subarray(len_vh, len_pkt)} } }\n\n\nfunction _mqtt_raw_pkt_dispatch(u8_pkt_dispatch) {\n  return (( _pkt_ctx_={} ) => {\n    const l = [new Uint8Array(0)]; // reuse array to prevent garbage collection churn on ephemeral ones\n    _pkt_ctx_._base_ = _pkt_ctx_;\n\n    return (( u8_buf ) => {\n      l[0] = 0 === l[0].byteLength\n        ? u8_buf : _u8_join(l[0], u8_buf);\n\n      const res = [];\n      while (true) {\n        const u8_pkt = _mqtt_raw_pkt_decode_v(l, _pkt_ctx_);\n        if (undefined !== u8_pkt) {\n          res.push(u8_pkt_dispatch(u8_pkt)); }\n        else return res} }) }) }\n\n\nfunction _u8_join(a, b) {\n  const alen = a.byteLength;\n  const r = new Uint8Array(alen + b.byteLength);\n  r.set(a, 0);\n  r.set(b, alen);\n  return r}\n\nconst _mqtt_pkt_id_dispatch = disp_parser =>\n  _mqtt_raw_pkt_dispatch (( pkt ) => {\n    const fn_disp = disp_parser[pkt.type_obj.id];\n    return undefined !== fn_disp\n      ? fn_disp.call(disp_parser, pkt)\n      : disp_parser[0](pkt)});\n\n\nconst _mqtt_bind_encode = enc_by_type =>\n  (( mqtt_level ) => {\n    mqtt_level = +mqtt_level || mqtt_level.mqtt_level;\n    return (( type, pkt ) =>\n      enc_by_type[type](mqtt_level, pkt) ) });\n\n\nfunction _bind_mqtt_session(mqtt_level, mqtt_decode_session, mqtt_encode_session) {\n  mqtt_level = mqtt_level || 4;\n  return (( _pkt_ctx_={mqtt_level} ) =>[\n    mqtt_decode_session(_pkt_ctx_)\n  , mqtt_encode_session(_pkt_ctx_)] ) }\n\nconst mqtt_decode_session =\n  _mqtt_pkt_id_dispatch(\n    mqtt_decode_ops_by_id);\n\nconst mqtt_encode_session =\n  _mqtt_bind_encode(\n    mqtt_encode_by_type);\n\nconst mqtt_session_v4 =\n  _bind_mqtt_session(4,\n    mqtt_decode_session,\n    mqtt_encode_session,);\n\nconst mqtt_session_v5 =\n  _bind_mqtt_session(5,\n    mqtt_decode_session,\n    mqtt_encode_session,);\n\nclass MQTTClient {\n  constructor(target) {\n    this._conn_ = this._transport(this);\n    this._disp_ = this._dispatch(this, target);}\n\n  /* async _send(type, pkt) -- provided by _transport */\n  /* _on_mqtt(pkt_list, self) -- provided by _dispatch */\n\n  auth(pkt) {return this._disp_send('auth', pkt, 'auth')}\n  connect(pkt) {return this._disp_send('connect', pkt, 'connack')}\n\n  disconnect(pkt) {return this._send('disconnect', pkt)}\n  publish(pkt) {\n    return pkt.qos > 0 \n      ? this._disp_send('publish', pkt, pkt)\n      : this._send('publish', pkt)}\n\n  subscribe(pkt) {return this._disp_send('subscribe', pkt, pkt)}\n  unsubscribe(pkt) {return this._disp_send('unsubscribe', pkt, pkt)}\n\n  async _disp_send(type, pkt, key) {\n    const res = this._disp_.future(key);\n    await this._send(type, pkt);\n    return res}\n\n  static with_api(api) {\n    class MQTTClient extends this {}\n    Object.assign(MQTTClient.prototype, api);\n    return MQTTClient} }\n\n\nObject.assign(MQTTClient.prototype,{\n  _transport: _mqtt_client_transport\n, _dispatch: _mqtt_client_dispatch} );\n\n\nfunction _mqtt_client_transport(client) {\n  const q = []; // tiny version of deferred\n  q.then = y => void q.push(y);\n  q.notify = v => {for (const fn of q.splice(0,q.length)) {fn(v);} };\n\n  const send0 = (async ( type, pkt ) => {\n    (await q)(type, pkt);});\n\n  client._send = send0;\n  return {\n    is_live: (() =>send0 !== client._send)\n  , reset() {client._send = send0;}\n\n  , set(mqtt_session, send_u8_pkt) {\n      const [mqtt_decode, mqtt_encode] =\n        mqtt_session();\n\n      const on_mqtt_chunk = u8_buf =>\n        client._on_mqtt(\n          mqtt_decode(u8_buf)\n        , client);\n\n      const send_pkt = (async ( type, pkt ) => {\n        send_u8_pkt(\n          mqtt_encode(type, pkt)); });\n\n\n      client._send = send_pkt;\n      q.notify(send_pkt);\n      return on_mqtt_chunk} } }\n\n\n\nconst _mqtt_client_cmdid_dispatch ={\n  get on_mqtt() {\n    const {cmdids, rotate:{td,n} } = this;\n    let ts = td + Date.now();\n    return (( pkt_list ) => {\n      for (const pkt of pkt_list) {\n        cmdids[pkt.id](this, pkt); }\n\n      if (Date.now() > ts) {\n        this.rotate_belt(n);\n        ts = td + Date.now();} }) }\n\n\n, resolve(key, pkt) {\n    for (const map of this.hashbelt) {\n      const entry = map.get(key);\n      if (undefined !== entry) {\n        map.delete(key);\n        entry[0](pkt);\n        return true} }\n    return false}\n\n, rotate:{n: 3, td: 1000 }// 3 * 1s buckets\n, rotate_belt(n) {\n    const {hashbelt} = this;\n    hashbelt.unshift(new Map());\n    for (const old of hashbelt.splice(n)) {\n      for (const entry of old.values()) {\n        entry[1]('expired');} } }\n\n, cmdids: ((() => {\n    return [\n      by_evt   // 0x0 reserved\n    , by_evt   // 0x1 connect\n    , by_type  // 0x2 connack\n    , by_evt   // 0x3 publish\n    , by_id    // 0x4 puback\n    , by_id    // 0x5 pubrec\n    , by_id    // 0x6 pubrel\n    , by_id    // 0x7 pubcomp\n    , by_evt   // 0x8 subscribe\n    , by_id    // 0x9 suback\n    , by_evt   // 0xa unsubscribe\n    , by_id    // 0xb unsuback\n    , by_evt   // 0xc pingreq\n    , by_evt   // 0xd pingresp\n    , by_evt   // 0xe disconnect\n    , by_type  ]// 0xf auth\n\n\n    function by_id(disp, pkt) {\n      disp.resolve(pkt.pkt_id, pkt); }\n\n    function by_type(disp, pkt) {\n      disp.resolve(pkt.type_obj.type, pkt);\n      by_evt(disp, pkt);}\n\n    async function by_evt({target}, pkt) {\n      const fn = target[`mqtt_${pkt.type_obj.type}`];\n      if (undefined !== fn) {\n        await fn.call(target, pkt);}\n      else {\n        await target.mqtt_pkt(pkt);} } })()) };\n\n\n\nfunction _mqtt_client_dispatch(client, target) {\n  if (null == target) {\n    target = client;}\n  else if ('function' === typeof target) {\n    target = {mqtt_pkt: target};}\n\n\n  const hashbelt = [new Map()];\n  let _hb_key, _pkt_id=100;\n  const _deferred_by_key = (...args) =>\n    hashbelt[0].set(_hb_key, args);\n\n  const _disp_ ={\n    __proto__: _mqtt_client_cmdid_dispatch\n  , target, hashbelt,\n\n    future(pkt_or_key) {\n      if ('string' === typeof pkt_or_key) {\n        _hb_key = pkt_or_key;}\n      else {\n        _pkt_id = (_pkt_id + 1) & 0xffff;\n        _hb_key = pkt_or_key.pkt_id = _pkt_id;}\n\n      return new Promise(_deferred_by_key)} };\n\n  client._on_mqtt = _disp_.on_mqtt;\n  return _disp_}\n\nfunction _mqtt_web_api(mqtt_session) {\n  return {\n    async with_websock(websock) {\n      if (null == websock) {\n        websock = 'ws://127.0.0.1:9001';}\n\n      if ('string' === typeof websock) {\n        websock = new WebSocket(websock, ['mqtt']);}\n\n      const {readyState} = websock;\n      if (1 !== readyState) {\n        if (0 !== readyState) {\n          throw new Error('Invalid WebSocket readyState') }\n\n        await new Promise(y =>\n          websock.addEventListener('open', y, {once: true}) ); }\n\n\n      const {_conn_} = this;\n      const on_mqtt_chunk = _conn_.set(\n        mqtt_session\n      , u8_pkt => websock.send(u8_pkt) );\n\n      websock.addEventListener('close',\n        _conn_.reset, {once: true});\n\n      websock.onmessage = (async ({ data }) => {\n        const u8_buf = new Uint8Array(\n          data instanceof ArrayBuffer ? data\n            : await data.arrayBuffer());\n\n        on_mqtt_chunk(u8_buf); });\n\n      return this} } }\n\nvar web = MQTTClient.with_api(\n  _mqtt_web_api(mqtt_session_v4));\n\nexport default web;\n//# sourceMappingURL=web.mjs.map\n","import MQTTClient from 'u8-mqtt-packet/esm/client/web.mjs'\n//import MQTTClient from 'u8-mqtt-packet/esm/tiny/web.mjs'\n\n::!>\n  const c = new MQTTClient @\\ pkt ::\n    const {type_obj, u8_body, b0, cmd, ... tip} = pkt\n    console.log @ `%c[mqtt ${type_obj.type}]: %o`, 'color: blue', tip\n\n  c.with_websock('ws://127.0.0.1:9001')\n\n  await c.connect @:\n    connect_flags: @{}\n      will_flag: 1\n      will_qos: 0\n\n    keep_alive: 60\n\n    payload: @{}\n      client_id: 'swh_demo'\n      will_topic: 'swh/aaa/awesome'\n      will_payload: 'will is awesome'\n\n  await delay(10)\n\n  await c.publish @:\n    topic: 'swh/test-topic'\n    payload: 'awesome from web'\n\n  await delay(10)\n\n  await c.disconnect()\n\nfunction delay(ms) ::\n  return @{} then(y) :: setTimeout(y,ms)\n\n"],"names":["encode_varint","n","a","ni","push","decode_varint","u8","vi","vi_tuple","mqtt_props_by_id","mqtt_props_entries","entries","prop_map","Map","id","type","name","plural","prop_obj","set","get","bind","Array","from","values","mqtt_type_reader","[object Object]","buf","idx","this","step","width","r","byteLength","i","len","i0","subarray","TextDecoder","decode","bin","utf8","FlagsType","fn_reason","end_part","prop_entries","rdr","mqtt_reader","has_more","value","U8_Reason","Number","reason","super","bind_reason_lookup","reason_entries","reason_map","_connect_flags_","reserved","clean_start","will_flag","will_qos","will_retain","password","username","_connack_flags_","session_present","_connack_reason_","_puback_reason_","_pubxxx_reason_","_mqtt_decode_pubxxx","pkt","u8_body","pkt_id","u16","u8_reason","mqtt_level","props","_subscription_options_","qos","retain","retain_handling","_mqtt_decode_suback","_ack_reason_","answers","_suback_reason_","_unsuback_reason_","_disconnect_reason_","_auth_reason_","mqtt_decode_noop","mqtt_decode_ops_by_id","err","Error","_base_","flags","connect_flags","u8_flags","keep_alive","payload","client_id","will_properties","will_topic","will_payload","hdr","dup","Boolean","topic","flush","topic_list","topics","opts","pack_u16","v","mqtt_type_writer","Object","assign","_pkt_writer","pack_u32","u8_buf","TextEncoder","encode","length","Uint8Array","_u16_bin","k","enc_flags","undefined","isNaN","prototype","_pool_","self","rope","header","vec","_mqtt_pkt_rope","mqtt_pkt_writer","pop","mqtt_pkt_writer_pool","_c_mqtt_proto","_enc_connect_flags","_enc_flags_connack","_mqtt_encode_pubxxx","wrt","return_code","as_pkt","_enc_subscribe_flags","_mqtt_encode_suback","key_answers","ans","mqtt_encode_by_type","connect","connack","publish","puback","pubrec","pubrel","pubcomp","subscribe","each","isArray","suback","unsubscribe","unsuback","pingreq","pingresp","disconnect","auth","mqtt_cmd_by_type","mqtt_type_entries","type_map","cmd","_mqtt_raw_pkt_decode_v","u8_ref","_pkt_ctx_","len_body","len_vh","len_pkt","b0","__proto__","type_obj","_mqtt_raw_pkt_dispatch","u8_pkt_dispatch","l","b","alen","_u8_join","res","u8_pkt","_bind_mqtt_session","mqtt_decode_session","mqtt_encode_session","disp_parser","fn_disp","call","enc_by_type","mqtt_session_v4","MQTTClient","target","_conn_","_transport","_disp_","_dispatch","_disp_send","_send","key","future","api","client","q","then","y","notify","fn","splice","send0","is_live","mqtt_session","send_u8_pkt","mqtt_decode","mqtt_encode","send_pkt","_on_mqtt","mqtt_pkt","hashbelt","_hb_key","_pkt_id","_deferred_by_key","args","_mqtt_client_cmdid_dispatch","pkt_or_key","Promise","on_mqtt","cmdids","rotate","td","ts","Date","now","pkt_list","rotate_belt","map","entry","delete","unshift","old","by_evt","by_type","by_id","disp","resolve","async","web","with_api","websock","WebSocket","readyState","addEventListener","once","on_mqtt_chunk","send","reset","onmessage","data","ArrayBuffer","arrayBuffer","setTimeout","console","c"],"mappings":"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"}